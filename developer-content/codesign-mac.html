
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Code-signing WISER on the Mac &#8212; WISER Docs</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=8f2a1f02" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="../_static/style.css?v=613452eb" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../_static/documentation_options.js?v=a11d3fb1"></script>
    <script src="../_static/doctools.js?v=9bcbadda"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'developer-content/codesign-mac';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="CI/CD and Releases" href="CI-CD-Releases.html" />
    <link rel="prev" title="Developing and Building WISER on MacOS X" href="devenv-mac.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search..."
         aria-label="Search..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../index.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/icon_128x128.png" class="logo__image only-light" alt="WISER Docs - Home"/>
    <script>document.write(`<img src="../_static/icon_128x128.png" class="logo__image only-dark" alt="WISER Docs - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../get-started.html">Getting started</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../user-manual.html">WISER User Manual</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../user-content/overview.html">WISER Overview</a></li>



<li class="toctree-l2"><a class="reference internal" href="../user-content/contrast-stretch.html">Contrast Stretch</a></li>
</ul>
</details></li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="../developer.html">Developing WISER</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="environment-setup.html">Environment setup</a></li>
<li class="toctree-l2"><a class="reference internal" href="devenv-win.html">Developing and Building WISER on Windows 10</a></li>
<li class="toctree-l2"><a class="reference internal" href="devenv-mac.html">Developing and Building WISER on MacOS X</a></li>
<li class="toctree-l2 current active"><a class="current reference internal" href="#">Code-signing WISER on the Mac</a></li>
<li class="toctree-l2"><a class="reference internal" href="CI-CD-Releases.html">CI/CD and Releases</a></li>
<li class="toctree-l2"><a class="reference internal" href="branching-strategy.html">Branching Strategy</a></li>
<li class="toctree-l2"><a class="reference internal" href="testing-standards.html">Testing Standards</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../contributing.html">Engaging With WISER</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../general-content/feature-submitting-guide.html">Feature Submitting Guide</a></li>
<li class="toctree-l2"><a class="reference internal" href="../general-content/bug-submitting-guide.html">Bug Submitting Guide</a></li>
</ul>
</details></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">


<a href="https://github.com/Ehlmann-research-group/WISER" target="_blank"
   class="btn btn-sm btn-source-repository-button"
   title="Source repository"
   data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>

</a>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/developer-content/codesign-mac.md" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.md</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Code-signing WISER on the Mac</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#code-signing-by-identified-developers">Code-signing by Identified Developers</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#preparing-to-notarize-from-the-command-line">Preparing to Notarize from the Command Line</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#code-signing-your-application">Code-Signing Your Application</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#building-a-disk-image-dmg-file">Building a Disk Image (.dmg) File</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#notarizing-the-disk-image">Notarizing the Disk Image</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#output-of-notarization">Output of Notarization</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#final-steps">Final Steps??</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#testing">Testing</a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="code-signing-wiser-on-the-mac">
<h1>Code-signing WISER on the Mac<a class="headerlink" href="#code-signing-wiser-on-the-mac" title="Link to this heading">#</a></h1>
<p>Code-signing has become a widely-accepted technique for verifying that
distributable binaries are from a known source, and also that they have
not been tampered with since they were built.  On the macOS platform,
code-signing is of even greater importance, since the Gatekeeper subsystem
will not allow a downloaded application binary to be run <em>at all</em>, unless
the binary was code-signed with a known developer key, and also notarized
by Apple.  This is a daunting hurdle to overcome, but it is surmountable.</p>
<p>This document describes how to code-sign and notarize an application for
MacOSX, using the WISER application as an example.</p>
<section id="code-signing-by-identified-developers">
<h2>Code-signing by Identified Developers<a class="headerlink" href="#code-signing-by-identified-developers" title="Link to this heading">#</a></h2>
<p>In order to code-sign an application, one must have an Identified Developer
key from Apple.  This requires signing up for the Apple Developer program,
a $99/yr expense.  Open the <a class="reference external" href="https://developer.apple.com/">Apple Developer</a>
site in a web browser, log in with your Apple ID, and pay to join the
developer program.</p>
<p>Once your developer account is active, you should be able to navigate to the
<a class="reference external" href="https://developer.apple.com/account/resources/certificates/list">Certificates, Identifiers &amp; Profiles</a>
page to see your certificates.</p>
<ol class="arabic">
<li><p>Click the blue “+” symbol to the right of the “Certificates” header
to create a new certificate.  This will take you to a new page with
the header “Create a New Certificate.”</p></li>
<li><p>The “Create a New Certificate” page presents a list of different
certificate types that you can request.  To code-sign applications
as an Identified Developer, select the “Developer ID Application”
option at the bottom of the list.</p>
<p>Then, select the blue “Continue” button back at the top of the page,
to go to the next step.</p>
</li>
<li><p>The next page in the “Create a New Certificate” workflow asks for a
Certificate Signing Request (CSR).  You can follow the instructions
linked from this page.</p>
<p>You can specify an Email Address and Common Name associated with your
project, or you can specify your own email and name for this key.
This information doesn’t seem to be reported to the user anywhere, so
in one sense it’s somewhat immaterial.</p>
<p>The main thing is, the key’s name will likely be your name from your
Apple ID account.</p>
<p>Once you have uploaded the CSR to this page,</p>
</li>
<li><p>Once you have created and uploaded a CSR, you can advance to the next
page, which will allow you to download your code-signing key.</p>
<p>When you download the key, your browser will likely ask if you want to
open the key in the Keychain Access tool that comes with macOS (in the
Applications/Utilities folder).  Go ahead and import it.</p>
</li>
</ol>
</section>
<section id="preparing-to-notarize-from-the-command-line">
<h2>Preparing to Notarize from the Command Line<a class="headerlink" href="#preparing-to-notarize-from-the-command-line" title="Link to this heading">#</a></h2>
<p>To notarize a Mac application, it must be uploaded to Apple servers using
your Apple ID login credentials.  Apple suggests that you create an
<em>app-specific password</em> for the notarization step, so that you don’t have
to use your main account password.</p>
<p>You can go to <a class="reference external" href="https://support.apple.com/en-us/HT204397">this Apple Support page</a>
to learn how to create an app-specific password.  <strong>Note that the password
will only be shown to you once, so don’t forget it!</strong></p>
<blockquote>
<div><p>I recommend storing this app-specific password in a “secret” config
file (i.e. the file contains secrets, not that the file is hidden),
that is <em>NOT</em> checked in to your code repository.  This way you can
automate your build, code-sign and notarization process without
sharing your app-specific password or other information with others.</p>
</div></blockquote>
</section>
<section id="code-signing-your-application">
<h2>Code-Signing Your Application<a class="headerlink" href="#code-signing-your-application" title="Link to this heading">#</a></h2>
<p>After your program has been built into a distributable form (e.g. by freezing
a Python application, or building your application’s binaries), but <em>before</em>
it has been packaged into a Disk Image (.dmg) file, it must be code-signed
using the Identified Developer key generated earlier.</p>
<p>This is an example of how you could codesign:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>codesign -s $(AD_CODESIGN_KEY_NAME) --deep --force \
        --entitlements install-mac/entitlements.plist \
        -o runtime dist/$(APP_NAME).app
</pre></div>
</div>
<p>However, the use of –deep is highly discouraged and has led to problems in
WISER development so we instead use a script to recursively search through
the WISER.app folder to sign files.</p>
<p>In the WISER Makefile, we simply run this script</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">bash</span> <span class="n">install</span><span class="o">-</span><span class="n">mac</span><span class="o">/</span><span class="n">sign_wiser</span><span class="o">.</span><span class="n">sh</span>
</pre></div>
</div>
<p>Here are descriptions of the relevant arguments <code class="docutils literal notranslate"><span class="pre">codesign</span></code>:</p>
<ul>
<li><p>The <code class="docutils literal notranslate"><span class="pre">AD_CODESIGN_KEY_NAME</span></code> is the name of the Identified Developer
key.  This is typically the name of the Apple ID account owner.</p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">APP_NAME</span></code> is simply the WISER application name (defined to be
“WISER” in this <code class="docutils literal notranslate"><span class="pre">Makefile</span></code>).</p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">--deep</span></code> argument is often necessary, particularly when the
application includes shared libraries (<code class="docutils literal notranslate"><span class="pre">.dylib</span></code> files) or other
binary programs.  If these additional binaries are not code-signed
(e.g. by their original provider, or by your build process), then
Apple’s notarization mechanism will complain.  The easy way to deal
with this situation is to just ensure that everything is code-signed
using your Identified Developer code-signing key.</p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">--force</span></code> argument is also necessary when shared libraries <em>are</em>
signed by their original providers.  In these cases, the <code class="docutils literal notranslate"><span class="pre">codesign</span></code> tool
will not replace the existing signature unless the command-line also
specifies this argument - and this will cause the notarization step to
fail.</p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">-o</span> <span class="pre">runtime</span></code> argument specifies the use of the
<a class="reference external" href="https://developer.apple.com/documentation/security/hardened_runtime">hardened runtime</a>,
which prevents certain kinds of exploits.  <strong>This option must be
specified for Apple notarization to succeed.</strong></p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">--entitlements</span></code> argument specifies various entitlements (i.e.
extra permissions) that should be granted to the application.  For
frozen Python applications, certain entitlements must be specified,
or else the application will not successfully run after installation.</p>
<p>The version from the <code class="docutils literal notranslate"><span class="pre">install-mac</span></code> directory is as follows:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>&lt;!-- From https://github.com/pyinstaller/pyinstaller/issues/4629 --&gt;
&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;!DOCTYPE plist PUBLIC &quot;-//Apple//DTD PLIST 1.0//EN&quot; &quot;http://www.apple.com/DTDs/PropertyList-1.0.dtd&quot;&gt;
&lt;plist version=&quot;1.0&quot;&gt;
&lt;dict&gt;
	&lt;!-- These are required for binaries built by PyInstaller --&gt;

    &lt;!-- supposedly unneeded
	&lt;key&gt;com.apple.security.cs.allow-jit&lt;/key&gt;
	&lt;true/&gt;
    --&gt;

	&lt;key&gt;com.apple.security.cs.allow-unsigned-executable-memory&lt;/key&gt;
	&lt;true/&gt;
&lt;/dict&gt;
&lt;/plist&gt;
</pre></div>
</div>
<p>Searching on the Internet can help resolve issues related to entitlements.
In particular, see the bug-report linked from the <code class="docutils literal notranslate"><span class="pre">entitlements.plist</span></code>
file above.</p>
</li>
</ul>
</section>
<section id="building-a-disk-image-dmg-file">
<h2>Building a Disk Image (.dmg) File<a class="headerlink" href="#building-a-disk-image-dmg-file" title="Link to this heading">#</a></h2>
<p>It is of value to build a distributable <code class="docutils literal notranslate"><span class="pre">.dmg</span></code> file from the application,
so that it’s simple to share with others.  The WISER build process uses
these steps:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>hdiutil create dist/tmp.dmg -ov -volname &quot;$(APP_NAME)&quot; -fs HFS+ -srcfolder dist/$(APP_NAME).app
hdiutil convert dist/tmp.dmg -format UDZO -o dist/$(APP_NAME)-$(APP_VERSION).dmg
rm dist/tmp.dmg
</pre></div>
</div>
<p>The first step generates a temporary disk image <code class="docutils literal notranslate"><span class="pre">tmp.dmg</span></code> that mounts with the
specified application name, and with the specified contents.</p>
<p>Note that the first step creates a read-write disk image.  Thus, the second
step is to take the <code class="docutils literal notranslate"><span class="pre">tmp.dmg</span></code> temporary image and prepare a read-only image
suitable for distribution.  Thus, this step writes its output to a filename
suitable for distribution.  The WISER build process generates a filename of
<code class="docutils literal notranslate"><span class="pre">WISER-&lt;versioninfo&gt;.dmg</span></code> (e.g. <code class="docutils literal notranslate"><span class="pre">WISER-1.0a4-dev0.dmg</span></code>), mounted with the
volume name <code class="docutils literal notranslate"><span class="pre">WISER</span></code>.</p>
</section>
<section id="notarizing-the-disk-image">
<h2>Notarizing the Disk Image<a class="headerlink" href="#notarizing-the-disk-image" title="Link to this heading">#</a></h2>
<p>This is possibly the most exciting and mysterious step of the entire process.
Once the Disk Image is generated from the previous step, it must be uploaded
to Apple for notarization. This operation requires a command like this:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>xcrun notarytool submit dist/$(APP_NAME)-$(APP_VERSION).dmg \
    --apple-id $(AD_USERNAME) \
    --team-id $(AD_TEAM_ID) \
    --password $(AD_PASSWORD)
</pre></div>
</div>
<p>Here are descriptions of the relevant arguments:</p>
<ul>
<li><p>The <code class="docutils literal notranslate"><span class="pre">--submit</span></code> argument specifies the distributable disk-image file that
you are requesting notarization for.</p>
<p><strong>Note that the disk image file will be uploaded to Apple for this
notarization process to be completed.</strong>  After that, it must be scanned
by Apple’s servers.  Thus, the command will take some time to finish the
upload, and a successful upload does <em>NOT</em> mean that the app has been
successfully notarized.</p>
<p>Note that the bundle-id is automatically retrieved from the disk image
we upload so we don’t need to specify it.</p>
</li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">AD_USERNAME</span></code> is the Apple ID of the account owner.  In the WISER
build process, this configuration is specified in the secret config file.</p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">AD_TEAM_ID</span></code> is the 10-character Developer Team ID. It is required<br />
when authenticating with Apple ID credentials.</p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">AD_PASSWORD</span></code> is the app-specific password you generated in an earlier
step.  In the WISER build process, this is also specified in the secret
config file.</p></li>
</ul>
<p>Previously, <code class="docutils literal notranslate"><span class="pre">xcrun</span> <span class="pre">atool</span> <span class="pre">--notarize</span></code> was used, but Apple deprecated <code class="docutils literal notranslate"><span class="pre">atool</span></code>
for notarization.</p>
<section id="output-of-notarization">
<h3>Output of Notarization<a class="headerlink" href="#output-of-notarization" title="Link to this heading">#</a></h3>
<p>When the notarization command completes, it will output some information that
can be used to monitor the notarization process.  Here is some example output:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">xcrun</span> <span class="n">notarytool</span> <span class="n">submit</span> <span class="n">dist</span><span class="o">/</span><span class="n">WISER</span><span class="o">-</span><span class="mf">1.3</span><span class="n">b1</span><span class="o">.</span><span class="n">dmg</span> \
                <span class="o">--</span><span class="n">apple</span><span class="o">-</span><span class="nb">id</span> <span class="o">&lt;</span><span class="n">secret</span><span class="o">&gt;</span> \
                <span class="o">--</span><span class="n">team</span><span class="o">-</span><span class="nb">id</span> <span class="o">&lt;</span><span class="n">secret</span><span class="o">&gt;</span>
                <span class="o">--</span><span class="n">password</span> <span class="o">&lt;</span><span class="n">secret</span><span class="o">&gt;</span>

<span class="n">Conducting</span> <span class="n">pre</span><span class="o">-</span><span class="n">submission</span> <span class="n">checks</span> <span class="k">for</span> <span class="n">WISER</span><span class="o">-</span><span class="mf">1.3</span><span class="n">b1</span><span class="o">.</span><span class="n">dmg</span> <span class="ow">and</span> <span class="n">initiating</span> <span class="n">connection</span> <span class="n">to</span> <span class="n">the</span> <span class="n">Apple</span> <span class="n">notary</span> <span class="n">service</span><span class="o">...</span>
<span class="n">Submission</span> <span class="n">ID</span> <span class="n">received</span>
  <span class="nb">id</span><span class="p">:</span> <span class="mi">21602</span><span class="n">dbf</span><span class="o">-</span><span class="n">e391</span><span class="o">-</span><span class="mi">4609</span><span class="o">-</span><span class="mf">96e2</span><span class="o">-</span><span class="n">efc4fec25633</span>
<span class="n">Upload</span> <span class="n">progress</span><span class="p">:</span> <span class="mf">100.00</span><span class="o">%</span> <span class="p">(</span><span class="mi">250</span> <span class="n">MB</span> <span class="n">of</span> <span class="mi">250</span> <span class="n">MB</span><span class="p">)</span>    
<span class="n">Successfully</span> <span class="n">uploaded</span> <span class="n">file</span>
  <span class="nb">id</span><span class="p">:</span> <span class="mi">21602</span><span class="n">dbf</span><span class="o">-</span><span class="n">e391</span><span class="o">-</span><span class="mi">4609</span><span class="o">-</span><span class="mf">96e2</span><span class="o">-</span><span class="n">efc4fec25633</span>
  <span class="n">path</span><span class="p">:</span> <span class="o">/</span><span class="n">Users</span><span class="o">/</span><span class="n">joshuagk</span><span class="o">/</span><span class="n">Documents</span><span class="o">/</span><span class="n">WISER</span><span class="o">/</span><span class="n">dist</span><span class="o">/</span><span class="n">WISER</span><span class="o">-</span><span class="mf">1.3</span><span class="n">b1</span><span class="o">.</span><span class="n">dmg</span>
</pre></div>
</div>
<p>The most important detail is the <em>id</em> of the request, which can be used to
monitor the status of the notarization process.  The <code class="docutils literal notranslate"><span class="pre">notarytool</span></code> program has a
second command <code class="docutils literal notranslate"><span class="pre">info</span></code> which can be used to fetch the status
of the notarization operation from the Apple servers.</p>
<p>You can run a command like this to fetch the notarization status (substitute
in the <code class="docutils literal notranslate"><span class="pre">RequestUUID</span></code> value above, and specify your Apple ID, team-id, and app-specific password):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">xcrun</span> <span class="n">notarytool</span> <span class="n">info</span> <span class="o">&lt;</span><span class="n">request</span><span class="o">-</span><span class="nb">id</span><span class="o">&gt;</span> <span class="o">--</span><span class="n">apple</span><span class="o">-</span><span class="nb">id</span> <span class="o">&lt;</span><span class="n">secret</span><span class="o">&gt;</span> <span class="o">--</span><span class="n">team</span><span class="o">-</span><span class="nb">id</span> <span class="o">&lt;</span><span class="n">secret</span><span class="o">&gt;</span> <span class="o">--</span><span class="n">password</span> <span class="o">&lt;</span><span class="n">secret</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>I like to run this in a loop so I don’t have to manually check on the
process:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">while</span> <span class="n">true</span> <span class="p">;</span> <span class="n">do</span> <span class="n">clear</span> <span class="p">;</span> <span class="n">xcrun</span> <span class="n">notarytool</span> <span class="n">info</span> <span class="o">&lt;</span><span class="n">request</span><span class="o">-</span><span class="nb">id</span><span class="o">&gt;</span> <span class="o">--</span><span class="n">apple</span><span class="o">-</span><span class="nb">id</span> <span class="o">&lt;</span><span class="n">secret</span><span class="o">&gt;</span> <span class="o">--</span><span class="n">team</span><span class="o">-</span><span class="nb">id</span> <span class="o">&lt;</span><span class="n">secret</span><span class="o">&gt;</span> <span class="o">--</span><span class="n">password</span> <span class="o">&lt;</span><span class="n">secret</span><span class="o">&gt;</span> <span class="p">;</span> <span class="n">sleep</span> <span class="mi">10</span> <span class="p">;</span> <span class="n">done</span>
</pre></div>
</div>
<p>If everything is correct, you will eventually see something like this:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Successfully</span> <span class="n">received</span> <span class="n">submission</span> <span class="n">info</span>
  <span class="n">createdDate</span><span class="p">:</span> <span class="mi">2025</span><span class="o">-</span><span class="mi">09</span><span class="o">-</span><span class="mi">30</span><span class="n">T20</span><span class="p">:</span><span class="mi">01</span><span class="p">:</span><span class="mf">36.033</span><span class="n">Z</span>
  <span class="nb">id</span><span class="p">:</span> <span class="mi">21602</span><span class="n">dbf</span><span class="o">-</span><span class="n">e391</span><span class="o">-</span><span class="mi">4609</span><span class="o">-</span><span class="mf">96e2</span><span class="o">-</span><span class="n">efc4fec25633</span>
  <span class="n">name</span><span class="p">:</span> <span class="n">WISER</span><span class="o">-</span><span class="mf">1.3</span><span class="n">b1</span><span class="o">.</span><span class="n">dmg</span>
  <span class="n">status</span><span class="p">:</span> <span class="n">Accepted</span>
</pre></div>
</div>
<p>Regardless of whether it succeeds or fails, once the notarization check is
finished, you should be able to navigate to the run the below command to
get detailed information about what happened during notarization.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">xcrun</span> <span class="n">notarytool</span> <span class="n">log</span> <span class="o">&lt;</span><span class="n">request</span><span class="o">-</span><span class="nb">id</span><span class="o">&gt;</span>
 <span class="o">--</span><span class="n">apple</span><span class="o">-</span><span class="nb">id</span><span class="o">=&lt;</span><span class="n">secret</span><span class="o">&gt;</span> <span class="o">--</span><span class="n">team</span><span class="o">-</span><span class="nb">id</span><span class="o">=&lt;</span><span class="n">secret</span><span class="o">&gt;</span> <span class="o">--</span><span class="n">password</span><span class="o">=&lt;</span><span class="n">secret</span><span class="o">&gt;</span>
</pre></div>
</div>
</section>
</section>
<section id="final-steps">
<h2>Final Steps??<a class="headerlink" href="#final-steps" title="Link to this heading">#</a></h2>
<p>Guess what?  If you you got to this point, you’re done!</p>
<p>You might expect that the notarized version of the app needs to be downloaded
from somewhere, but it actually doesn’t work that way.  When you notarize
a macOS application for distribution, Apple simply records key details about
the code-signed app and its packaging, and it scans the app’s binaries for
known malware.</p>
<p>Later, when users try to run your application, the Gatekeeper subsystem on
their computer will talk to the Apple servers, to check this information
recorded during notarization.</p>
<p>Thus, you are now ready to distribute your code-signed <code class="docutils literal notranslate"><span class="pre">.dmg</span></code> file to your
users!</p>
<section id="testing">
<h3>Testing<a class="headerlink" href="#testing" title="Link to this heading">#</a></h3>
<p>If you want to test your code-signed and notarized application, you will
need to upload it to some remote server, then download it to your computer
and try to run it (or install it into your Applications folder and then
run it).  Non-code-signed applications can be built and run locally; as
long as they weren’t downloaded from somewhere, macOS will run them.  So,
to perform a real test of your code-signed and notarized application, you
will need to put it on some remote system, then download it and attempt to
use it.</p>
</section>
</section>
</section>


                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="devenv-mac.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Developing and Building WISER on MacOS X</p>
      </div>
    </a>
    <a class="right-next"
       href="CI-CD-Releases.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">CI/CD and Releases</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#code-signing-by-identified-developers">Code-signing by Identified Developers</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#preparing-to-notarize-from-the-command-line">Preparing to Notarize from the Command Line</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#code-signing-your-application">Code-Signing Your Application</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#building-a-disk-image-dmg-file">Building a Disk Image (.dmg) File</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#notarizing-the-disk-image">Notarizing the Disk Image</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#output-of-notarization">Output of Notarization</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#final-steps">Final Steps??</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#testing">Testing</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Joshua Garcia-Kimble
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2025, Joshua Garcia-Kimble.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>